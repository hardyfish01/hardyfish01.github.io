---
title: 索引规约
categories: 
- 读书笔记
- 阿里Java开发手册
- MySQL数据库
---

1.业务上具有唯一特性的字段，即使是多个字段的组合，也必须建成唯一索引。

> 说明：不要以为唯一索引影响了insert速度，这个速度损耗可以忽略，但提高查找速度是明显的；

2.超过三个表禁止join。需要join的字段，数据类型必须绝对一致；多表关联查询时，保证被关联的字段需要有索引。

> 说明：即使双表join也要注意表索引、SQL性能。

3.在varchar字段上建立索引时，必须指定索引长度，没必要对全字段建立索引，根据实际文本区分度决定索引长度即可。

4.如果有order by的场景，请注意利用索引的有序性。

order by 最后的字段是组合索引的一部分，并且放在索引组合顺序的最后，避免出现file_sort的情况，影响查询性能。

>正例：where a=? and b=? order by c; 索引：a_b_c
>
>反例：索引中有范围查找，那么索引有序性无法利用，如：WHERE a>10 ORDER BY b; 索引a_b无法排序。

5.利用覆盖索引来进行查询操作，避免回表。

> 利用延迟关联或者子查询优化超多分页场景。

6.SQL性能优化的目标：至少要达到 range 级别，要求是ref级别，如果可以是consts最好。

7.建组合索引的时候，区分度最高的在最左边。

正例：如果where a=? and b=? ，a列的几乎接近于唯一值，那么只需要单建idx_a索引即可。

说明：存在非等号和等号混合判断条件时，在建索引时，请把等号条件的列前置。

> 如：where a>? and b=? 那么即使a的区分度更高，也必须把b放在索引的最前列。

8.防止因字段类型不同造成的隐式转换，导致索引失效。