---
title: 性能指标
categories: 
- 分布式
---

**TPS**

每秒事务数。

一个事务是指客户端向服务器发送请求然后服务器做出反应的过程，具体的事务定义，可以是一个接口、多个接口、一个业务流程等等。

以单接口定义为事务举例，每个事务包括了如下3个过程：

* 向服务器发请求

* 服务器自己的内部处理（包含应用服务器、数据库服务器等）

* 服务器返回结果给客户端

如果每秒能够完成 N 次以上3个过程，TPS 就是 N。

**QPS**

每秒查询率。指一台服务器每秒能够响应的查询次数，用于衡量特定的查询服务器在规定时间内所处理流量多少，主要针对专门用于查询的服务器的性能指标。

它不包含复杂的业务逻辑处理，比如数据库中的每秒执行查询SQL的次数。

QPS 只是一个简单查询的统计显然，不能描述增删改等操作，显然它不够全面，所以不建议用 QPS 来描述系统整体的性能；

**平均响应时间**

通常，平均响应时间体现的是服务接口的平均处理能力。

计算方式就是把所有的请求所耗费的时间加起来，然后除以请求的次数。

比如：我们向一个网站发送了5次请求，每次请求所耗费的时间分别为：1ms，2ms，1ms，3ms，2ms，那么，平均响应时间就是`(1+2+1+3+2)/5 = 1.8ms`，所以，平均响应时间就是1.8ms。

平均响应时间这个指标存在一个问题：

> 如果在短时间内请求变得很慢，但很快过去了，此时使用平均响应时间就无法很好的体现出性能的波动问题。

**百分位数**

百分位数就是圈定一个时间范围，把每次请求的耗时加入一个列表中，然后按照从小到大的顺序将这些时间进行排序。

这样，我们取出特定百分位的耗时，这个数字就是 TP 值。

> 通俗理解：TP99 100ms，99%的查询都能在100ms内返回。

百分位数这个指标它反映的是应用接口的整体响应情况。

**举个例子：**

有四次请求耗时分别为： 10ms，1000ms，100ms，2ms。

首先，要对这次排序为： 2ms，10ms，100ms，1000ms。

计算方式：`总次数 * 指标数 = TP指标的序号`

那么可以这样计算TP99：4次请求中，99%的请求数为`4*0.99 = 3.96`，进位取整也就是4，TP99的答案是1000ms。 

