---
title: 跳跃表
categories: 
- 数据结构和算法分析
---

**跳表(SkipList)**

跳跃表是基于链表扩展实现的一种特殊链表，类似于树的实现，跳跃表不仅实现了横向链表，还实现了垂直方向的分层索引。

一个跳跃表由若干层链表组成，每一层都实现了一个有序链表索引，只有最底层包含了所有数据，每一层由下往上依次通过一个指针指向上层相同值的元素，每层数据依次减少，等到了最顶层就只会保留部分数据了。

跳跃表的这种结构，是利用了空间换时间的方法来提高了查询效率。程序总是从最顶层开始查询访问，通过判断元素值来缩小查询范围。

* 跳表是一个随机化的数据结构，实质是一种可以进行二分查找的有序链表。

* 跳表在原有的有序链表上增加了多级索引，通过索引来实现快速查询。

* 跳表不仅能提高搜索性能，同时也可以提高插入和删除操作的性能

* 对链表建立索引，每两个结点提取一个结点到上一级，我们把抽取出来的那一级叫做索引或者索引层

**实现过程：**

首先是一个初始化的跳跃表：

<img src="https://img-blog.csdnimg.cn/2b90958777074cac8c779c25cd8fcb71.png" style="zoom:50%;" />

当查询key值为9的节点时，此时查询路径为：

<img src="https://img-blog.csdnimg.cn/d1834d4900884d97b141ad4f4ecaa625.png" style="zoom:50%;" />

当新增一个key值为8的节点时，首先新增一个节点到最底层的链表中，根据概率算出level值，再根据level值新建索引层，最后链接索引层的新节点。新增节点和链接索引都是基于CAS操作实现。

<img src="https://img-blog.csdnimg.cn/ab36e41d271842d3bd8ef34dd6ed8a0e.png" style="zoom:50%;" />

当删除一个key值为7的结点时，首先找到待删除结点，将其value值设置为null；

之后再向待删除结点的next位置新增一个标记结点，以便减少并发冲突；

然后让待删结点的前驱节点直接越过本身指向的待删结点，直接指向后继结点，中间要被删除的结点最终将会被JVM垃圾回收处理掉；

最后判断此次删除后是否导致某一索引层没有其它节点了，并视情况删除该层索引 。

<img src="https://img-blog.csdnimg.cn/e7fdf5e1ef274cf8aa50fdf91ec40c7d.png" style="zoom:50%;" />

**跳跃表和红黑树区别**

* 红黑树插入，删除结点时，是通过调整结构来保持红黑树的平衡，比起跳跃表直接通过一个随机数来决定跨越几层，在时间复杂度的花销上是要高于跳跃表的。

**总结特性**

* 跳跃表的每一层都是一条**有序的链表**

* 跳跃表的查找次数近似于层数，时间复杂度为`O(logn)`，插入、删除也为 `O(logn)`

* 最底层的链表包含所有元素。

* 跳跃表是一种随机化的数据结构(通过抛硬币来决定层数)。

* 跳跃表的空间复杂度为 O(n)