---
title: Explain
categories: 
- 高性能MySQL
---

[最完整的Explain总结，SQL优化不再困难](https://blog.csdn.net/qq_35508033/article/details/121057021)

[最完整的Explain总结，SQL优化不再困难](https://mp.weixin.qq.com/s/twTghH8wTA_0uZghOdawkw)

**案例1：**

一个SQL：`select * from table where x1=xx and x2=xx`，x1和x2两个字段分别都有一个索引

* 可能会让查询优化器生成一个执行计划，执行计划里，就先对x1字段的索引树进行查找，查出一波数据，接着对x2的索引树查出一波数据，然后对两波数据，按照主键值做一个交集。

* 这个交集就是符合两个条件的数据了，接着回表到聚簇索引去查完整数据就可以了。

或者选择x1或者x2其中一个字段的索引，就查一个字段的索引，找出一波数据，接着直接回表到聚簇索引查完整数据，然后根据另外一个字段的值进行过滤就可以了。

**什么情况下，会直接对两个字段的两个索引一起查，然后取交集再回表到聚簇索引呢？**

比如x1和x2两个字段，如果先查x1字段的索引，有上万条数据，这上万条数据都回表到聚簇索引查完整数据，再根据x2来过滤，效果不是太好？

* 如果说同时从x2的索引树里也查一波数据出来，做一个交集，一下子就可以让交集的数据量变成几十条，再回表查询速度就很快了。

一般来说，查索引树速度都比较快，但是到聚簇索引回表查询会慢一些。

所以如果同时查两个索引树取一个交集后，数据量很小，然后再回表到聚簇索引去查，此时会提升性能。

* 在执行SQL语句的时候，有可能是会同时查多个索引树取个交集，再回表到聚簇索引的，这个可能性是有的。

一个SQL里用多个索引，意思就是可能对多个索引树进行查找，接着用intersection交集、union并集的方式来进行合并，此时可能在执行计划里也会看到这些字样，其实就是查找了多个索引，做了一些结果集的交集或者是并集，而且这种方式也不一定是会发生的。