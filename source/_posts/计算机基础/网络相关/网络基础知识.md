---
title: 网络基础知识
categories: 
- 计算机基础
- 网络相关
---

# 协议

**协议定义：**

计算机与计算机之间通过网络实现通信事先达成的一种约定。

这种约定使那些由不同厂商的设备、不同的CPU以及不同的操作系统组成的计算机之间，只要遵循相同的协议就能够实现通信。

反之，如果使用的协议不同，就无法通信。

> （举例人与人之间对话，汉语和英语当作协议，聊天当作通信，说话的内容当作数据，只会汉语和只会英语的人就无法通信）

![](https://img-blog.csdnimg.cn/5b46d323da8645e18eb9ae23055815f9.png)

**分组交换：**

将大数据分割为一个个叫做包（Packet）的较小单位进行传输的方法。

这里所说的包，就如同我们平常在邮局里见到的邮包。

> 分组交换就是将大数据分装为一个个这样的邮包交给对方。

# OSI七层模型

<img src="https://img-blog.csdnimg.cn/cec1f2d82bc54785a4ed03241da45f6c.png" style="zoom:25%;" />

| 层级 | 分层名称   | 功能                                     |
| ---- | ---------- | ---------------------------------------- |
| 7    | 应用层     | 针对特定应用的协议                       |
| 6    | 表示层     | 设备固有数据格式和网络标准数据格式的转换 |
| 5    | 会话层     | 通信管理                                 |
| 4    | 传输层     | 管理两个节点之间的数据传输               |
| 3    | 网络层     | 地址管理和路由选择                       |
| 2    | 数据链路层 | 互连设备之间传送和识别数据帧             |
| 1    | 物理层     | 比特流与电子信号之间的切换               |

**7层通信实例：**

假设主机A的用户A要给主机B的用户B发送一封电子邮件，邮件内容为早上好：

<img src="https://img-blog.csdnimg.cn/b01ed91b7a8e4f0bad03c3fa84f90254.png" style="zoom:25%;" />

发送方从第7层、第6层到第1层由上至下按照顺序传输数据，而接收端则从第1层、第2层到第7层由下至上向每个上一级分层传输数据。

* 每个分层上，在处理由上一层传过来的数据时可以附上当前分层的协议所必须的首部信息。

* 然后接收端对收到的数据进行数据首部与内容的分离，再转发给上一分层，并最终将发送端的数据恢复为原装。

* 应用层：目标地址为B，发件人为用户A，邮件内容为早上好

* 表示层：将数据（即邮件内容早上好）从主机特有的格式转换为网络标准传输格式

* 会话层：决定采用哪个连接发送。假设用户A新建了5封电子邮件准备发给B，这5封邮件的发送顺序可以有很多种。可以每发一封邮件时建立一次连接，随后断开；还可以建立一次连接连续发送5次；还可以同时建立5个连接，同时发送。决定采用何种连接方式是会话层的主要责任。

* 传输层：确立连接与断开连接重发。例子中的数据早上好可能因为某些原因导致数据被破坏，或者网络异常导致只有部分数据到达目的地址；用户B最后只收到早上这部分数据。此时用户A就需要重发，保证数据传输的可靠性就是传输层的一个重要作用。然而将数据传输给对端的处理是由网络层完成的。

* 网络层：在网络与网络互相互连接的环境中，将数据从发送端主机发送到接收端主机。
* 数据链路层：在通过（物理的）传输介质互连的设备间进行数据处理。
* 物理层：将数据的0、1转换为电压和脉冲光传输给物理的传输介质，相互直连的设备之间使用MAC地址（采用MAC地址是为了识别连接到同一传输介质上的设备）进行传输。

> 网络层与数据链路层都是基于目标地址将数据发送给接收端的，但网络层负责将整个数据发送给最终目标地址，而数据链路层只负责发送一个分段内的数据。

**物理层**

首先解决两台物理机之间的通信需求，具体就是机器A往机器B发送比特流，机器B能收到比特流。

* 物理层主要定义了物理设备的标准，如网线的类型，光纤的接口类型，各种传输介质的传输速率。

主要作用是传输比特流（`0101`二进制数据），将比特流转化为电流强弱传输，到达目的后再转化为比特流，即常说的数模转化和模数转换。

* 这层数据叫做比特。**网卡工作在这层**。

> 集线器

这种设备有多个口，可以将宿舍里的多台电脑连接起来。但是，和交换机不同，集线器没有大脑，它完全在物理层工作。

* 它会将自己收到的每一个字节，都复制到其他端口上去。这是第一层物理层联通的方案。

这种组网的方法，对一个宿舍来说没有问题，但是一旦机器数目增多，问题就出现了。

* 因为Hub是广播的，不管某个接口是否需要，所有的Bit都会被发送出去，然后让主机来判断是不是需要。

因为每个口都只连接一台电脑，这台电脑又不怎么换IP和MAC地址，只要记住这台电脑的MAC地址，如果目标MAC地址不是这台电脑的，这个口就不用转发了。

> 怎么知道目标MAC地址是否就是连接某个口的电脑的MAC地址呢？

这就需要一个能把MAC头拿下来，检查一下目标MAC地址，然后根据策略转发的设备，这个设备显然是个二层设备，我们称为**交换机**。

> 交换机怎么知道每个口的电脑的MAC地址呢？这需要交换机会学习。

一台MAC1电脑将一个包发送给另一台MAC2电脑，当这个包到达交换机的时候，一开始交换机也不知道MAC2的电脑在哪个口，所以没办法，它只能将包转发给除了来的那个口之外的其他所有的口。

但是，这个时候，交换机会干一件非常聪明的事情，就是交换机会记住，MAC1是来自一个明确的口。

以后有包的目的地址是MAC1的，直接发送到这个口就可以了。

* 当交换机作为一个关卡一样，过了一段时间之后，就有了整个网络的一个结构了，这个时候，基本上不用广播了，全部可以准确转发。

* 当然，每个机器的IP地址会变，所在的口也会变，因而交换机上的学习的结果，我们称为**转发表**，是有一个过期时间的。

有了交换机，一般来说，你接个几十台、上百台机器打游戏，应该没啥问题。你可以组个战队了。能上网了，就可以玩网游了。

**数据链路层**

在传输比特流的过程中，会产生错传、数据传输不完整的可能。

* 数据链路层定义了**如何格式化数据进行传输**，以及如何控制对物理介质的访问。通常提供错误检测和纠正，以确保数据传输的准确性。

本层将比特数据组成帧，交换机工作在这层，对帧解码，并根据帧中包含的信息把数据发送到正确的接收方。

* 该层负责物理层面上互连的节点之间的通信传输。例如与1个以太网相连的两个节点间的通讯。

常见的协议有 `HDLC、PPP、SLIP`等

数据链路层会将`0、1`序列划分为具有意义的数据帧传送给对端（**数据帧的生成与接收**）

**网络层**

随着网络节点的不断增加，点对点通讯需要通过多个节点，如何找到目标节点，如何选择最佳路径成为首要需求。

* 网络层主要功能是将网络地址转化为对应的物理地址，并决定如何将数据从发送方路由到接收方。

网络层通过综合考虑发送优先权、网络拥塞程度、服务质量以及可选路由的花费来决定从一个网络中节点A到另一个网络中节点B的最佳路径。

* 由于网络层处理并智能指导数据传送，路由器连接网络隔断，所以路由器属于网络层。

此层的数据称之为数据包。本层需要关注的协议`TCP/IP`协议中的IP协议。

网络层负责将数据传输到目标地址。目标地址可以使多个网络通过路由器连接而成的某一个地址。因此这一层主要负责**寻址和路由选择**。主要由 `IP、ICMP` 两个协议组成。

网络层将数据从发送端的主机发送到接收端的主机，两台主机间可能会存在很多数据链路，但网络层就是负责找出一条相对顺畅的通路将数据传递过去。传输的地址使用的是IP地址。IP地址通过不断转发到更近的IP地址，最终可以到达目标地址。

![](https://img-blog.csdnimg.cn/74f18ce814a84f34bfe492b76dfe6619.png)

**传输层**

随着网络通信需求的进一步扩大，通信过程中需要发送大量的数据，如海量文件传输，可能需要很长时间，网络在通信的过程中会中断很多次，此时为了保证传输大量文件时的准确性，需要对发送出去的数据进行切分，切割为一个一个的段落（`Segement`）发送，其中一个段落丢失是否重传，段落是否按顺序到达，是传输层需要考虑的问题。

* 传输层解决了主机间的数据传输，数据间的传输可以是不同网络，并且传输层解决了**传输质量**的问题。

传输层需要关注的协议有TCP/IP协议中的`TCP`协议和`UDP`协议。

**会话层**

自动收发包，自动寻址。

* 会话层作用是**负责建立和断开通信连接**，何时建立，断开连接以及保持多久的连接。常见的协议有 `ADSP、RPC` 等

**表示层**

Linux给WIndows发包，不同系统语法不一致，如exe不能在`Linux`下执行，shell不能在Windows不能直接运行。于是需要表示层。

* 解决**不同系统之间通信语法问题**，在表示层数据将按照网络能理解的方案进行格式化，格式化因所使用网络的不同而不同。

它主要负责数据格式的转换。具体来说，就是讲设备固有的数据格式转换为网络标准格式。常见的协议有`ASCII、SSL/TLS` 等

**应用层**

规定发送方和接收方必须使用一个固定长度的消息头，消息头必须使用某种固定的组成，消息头中必须记录消息体的长度等信息，方便接收方正确解析发送方发送的数据。

* 应用层旨在更**方便应用从网络中接收的数据**，重点关注`TCP/IP`协议中的HTTP协议

**注意：**

* 四层传输层数据被称作**段**（Segments）；

* 三层网络层数据被称做**包**（Packages）；

* 二层数据链路层时数据被称为**帧**（Frames）；

* 一层物理层时数据被称为**比特流**（Bits）。

# 网络设备

| 设备             | 作用                             |
| ---------------- | -------------------------------- |
| 网卡             | 使计算机连网的设备               |
| 中继器           | 从物理层上延长网络的设备         |
| 网桥/2层交换机   | 从数据链路层上延长网络的设备     |
| 路由器/3层交换机 | 通过网络层转化分组数据的设备     |
| 4~7层交换机      | 处理传输层以上各层网络传输的设备 |
| 网关             | 转换协议的设备                   |

**交换机**

> 交换机可以接入多台电脑

每个电脑网卡的 **MAC 地址**都是不一样的，电脑发送数据时，数据头部携带网卡的 MAC 地址，用 MAC 地址标识来不同的电脑

* 交换机就可以识别数据头部的 MAC 地址来区分不同的电脑

* 交换机除了能识别不同的电脑，还需要找到电脑连接的**交换机端口**，才能顺利的把数据从相应端口发送出去

交换机通过**自学机制**，把学习到的设备 MAC 地址和交换机端口号添加到 **MAC 地址表**，并根据 MAC 地址表进行数据**转发**

**路由器**

> 交换机需要记录的 MAC 地址表也越来越多，需要的交换机也越来越多

但是交换机的**容量和性能有限**，MAC 地址表无法记录全世界电脑的 MAC 地址和对应的端口号，MAC 地址表太大也无法快速查找到对应的 MAC 地址表项

* 于是就有了三层网络设备**路由器**，路由器可以把全世界的网络连接起来

局域网内的网络连接可以使用**交换机**，例如一个公司内的网络或者一个校园内的网络通过交换机连接

不同区域的局域网互联使用**路由器**

> 那么如何区分不同的网络区域呢？又是如何跨网络区域进行数据转发的呢？

* 路由器有多个端口，分别连接不同的网络区域，不同网络区域的 IP 地址**网络号不同**

它通过识别目的 IP 地址的**网络号**，再根据**路由表**进行数据转发

# 传输方式

面向有连接：发送数据之前，需要在收发主机之间连接一条通信线路。类似于平常打电话。

面向无连接：发送端可于任何时候自由发送数据，接收端不知道自己会在何时从哪里收到数据。所以接收端需要时常确认是否收到了数据。类似于人们去邮局寄包裹。

> 电路交换：

电路交换中交换机负责数据的中转处理。

计算机之间发送数据时需要通过交换机与目标主机建立通信电路。**连接电路称为建立连接**。如果某条电路只是用来连接两台计算机的通信线路，这两台计算机是可以独占线路进行数据传输的；如果一条电路上连接了多台计算机，其他计算机只能等待独占电路的计算机收发信息完毕后才有机会使用电路。如果并发用户数超过交换机之间的通信线路数，通信无法实现。

> 分组交换：

让连接到通信线路的计算机将所要发送的数据分成多个数据包，按照一定的顺序排列之后分别发送。

这样所有的计算机就可以一齐收发数据，提高通信线路的利用率。

<img src="https://img-blog.csdnimg.cn/23805b7f155446dd809b0af481a6e741.png" style="zoom:25%;" />

> 分组交换过程：

发送端计算机将数据分组发送给交换机（路由器），路由器收到这些分组数据以后缓存到自己的缓冲区，然后转发给目标表计算机。

<img src="https://img-blog.csdnimg.cn/039bf48508074f499a2eaa06fe8588a0.png" style="zoom:25%;" />

电路交换中，计算机间传输速度不变；分组交换中，由于网络拥堵，通信线路的速度可能有所不同。

路由器的缓存饱和或溢出时，甚至出现分组数据丢失、无法发送到对端。

**单薄、广播、多播、任播**

<img src="https://img-blog.csdnimg.cn/b0442a9776144c22a93d0fc08d37d79b.png" style="zoom:25%;" />

多播：与广播类似，也是将消息发给多个接收主机。但广播不需要限定接收端，而多播需要限定某一组主机作为接收端。

任播：在特定的多台主机中选出一台作为接收端。任播与多播类似，都是面向特定的一群主机。但任播会从目标主机群中选择一台最符合网络条件的主机作为目标主机发送消息。被选中的那台特定主机会返回一个单薄信号，随后发送端主机会只跟这台主机进行通信。